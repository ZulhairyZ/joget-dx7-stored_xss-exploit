# joget-dx7-stored_xss-PoC
Stored XSS vulnerability was found in Joget application that use audit trail element in their form. This is a PoC of exploiting the hidden element to perform XSS attack on Joget DX7 Version 7.0.38. 

Affected Component: https://dev.joget.org/community/display/DX7/Form+Data+Audit+Trail
# Initial Encounter
When trying to submit a form in the application, we intercept and inspect the form data before sending it. There is a hidden field with the class "*xxx_history_log*". 
we tried to inject scripts in multiple fields, mainly consisting "*hidden fields*" or "*audit trail element*" type. 

After submitting, the alert script in "*audit trail element*" popped up in the submitted form, where users or admins with access can view and execute it.

![Pasted image 20240627094251](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/72c97e59-08a9-451e-ac7f-72269dbd18dd)
![Pasted image 20240627093439](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/6ccb2cbf-a164-4437-8c40-8f7b4411ef02)

# PoC
Out of curiosity, we checked the form settings of the previous vulnerable application in Joget editor and found the following:
![Pasted image 20240627094445](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/e39d5af3-5054-4569-94f6-765519640b0d)

To further prove the injection works for any field in "*Store Audit Trail Element*", we tried it on another application with the following configuration:
![Pasted image 20240627094806](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/4aab5a3d-663f-4cef-ba88-1eb8d983c028)
![Pasted image 20240627095801](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/0130f203-2088-454a-b91d-fe4ce2a0ea2b)

In this application, the "*history_log*" does not take any input like previous application, as it takes input from "*history_status*" and "*history_remarks*" and stores it in audit element. 
## Recreating the exploit:
![Pasted image 20240627102508](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/f553beb1-5eb6-42bd-b21c-11ccb119f642)
![Pasted image 20240627102552](https://github.com/ZulhairyZ/joget-dx7-stored_xss-PoC/assets/152463887/1366eec7-cd3a-40b7-9118-dce1b8a13921)

# Others
Hidden fields are commonly used to pass/set temporary or session-based information. Most form elements consist of hidden fields to temporary pull data from database and display it for user's convenience. 

Form Data Audit Trail plugin tracks the form data events and records them in a table. For example, any submission or processing of data (depending on the application) will be tracked then displayed OR hidden (depends on developer's configuration).

> It still requires more trial and error with Joget forms to determine the exact configuration that will trigger this vulnerability. From our current tests, audit trail element has a higher chance that triggers the Stored XSS vulnerability.

# Reference
- https://dev.joget.org/community/display/DX7/Form+Data+Audit+Trail
